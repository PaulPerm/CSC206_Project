{% extends "base.html" %}
{% block title %}Vehicle Details{% endblock %}

{% block content %}
<section class="section">
  <div class="container">

    <h2 class="title is-3 has-text-centered">Vehicle Details</h2>

    <div class="box">

      <p><strong>VIN:</strong> {{ vehicle.vin }}</p>
      <p><strong>Type:</strong> {{ vehicle.vehicle_type_name }}</p>
      <p><strong>Year:</strong> {{ vehicle.model_year }}</p>
      <p><strong>Manufacturer:</strong> {{ vehicle.manufacturer_name }}</p>
      <p><strong>Model:</strong> {{ vehicle.model_name }}</p>
      <p><strong>Fuel Type:</strong> {{ vehicle.fuel_type }}</p>
      <p><strong>Colors:</strong> {{ vehicle.colors }}</p>
      <p><strong>Description:</strong> {{ vehicle.description }}</p>

    </div>

    
    {% if session.get('role') == 'Sales' %}
      <div class="box has-background-light">
        <h3 class="title is-5">Sales Options</h3>
        <a href="{{ url_for('sell_vehicle', vehicle_id=vehicle.vehicleID) }}" class="button is-warning">
          Sell Vehicle
        </a>
      </div>
    {% endif %}

    
    {% if session.get('role') == 'Buyer' %}
      <div class="box has-background-light">

        <h3 class="title is-5">Repair Parts</h3>

        {% if parts %}
        <table class="table is-fullwidth is-striped">
          <thead>
            <tr>
              <th>Part #</th>
              <th>Description</th>
              <th>Cost</th>
              <th>Qty</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for part in parts %}
            <tr>
              <td>{{ part.part_number }}</td>
              <td>{{ part.description }}</td>
              <td>${{ part.cost }}</td>
              <td>{{ part.quantity }}</td>
              <td>{{ part.status }}</td>
              
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
          <p class="has-text-grey">No parts ordered for this vehicle.</p>
        {% endif %}

      </div>
    {% endif %}

    
    {% if session.get('role') == 'Owner' %}
      <div class="box has-background-light">

        <h3 class="title is-5">Owner Information</h3>

        {% if seller %}
        <p><strong>Purchased From:</strong> {{ seller.first_name }} {{ seller.last_name }}</p>
        <p><strong>Seller Phone:</strong> {{ seller.phone }}</p>
        <p><strong>Seller Email:</strong> {{ seller.email }}</p>
        {% else %}
        <p>No seller data recorded.</p>
        {% endif %}

        {% if buyer %}
        <hr>
        <p><strong>Sold To:</strong> {{ buyer.first_name }} {{ buyer.last_name }}</p>
        <p><strong>Buyer Phone:</strong> {{ buyer.phone }}</p>
        <p><strong>Buyer Email:</strong> {{ buyer.email }}</p>
        {% else %}
        <p>Vehicle has not been sold.</p>
        {% endif %}

      </div>
    {% endif %}

    <a href="{{ url_for('vehicles') }}" class="button is-light">Back to Vehicles</a>

  </div>
</section>
{% endblock %}
